---
layout: article
title: 单生产者单消费者无锁队列
aside:
  toc: true
tags: lock-free-queue
---

在多线程访问同一块数据时，往往需要加锁来保证数据一致性，但在特殊场景下，队列可以lock-free地实现线程安全。这里是真正的线程安全，不需要依靠CAS操作、内存屏障这些操作系统提供的设施来实现。
<!--more-->

## 场景
所谓的特殊场景，就是只有**单个生产者，单个消费者**。这里介绍一下我在工作中遇到的一种场景：

`场景`{:.info} **监听线程向工作线程分发新的客户端连接**

```mermaid
graph TB;
    A[Listener]
    B[Worker1]
    C[Worker2]
    D[Worker3]
    E[Worker4]
    A--连接队列-->B;
    A--连接队列-->C;
    A--连接队列-->D;
    A--连接队列-->E;
```
这里Listener线程监听某一端口上的客户端连接，建立好连接后，根据某种负载均衡策略选择一个Worker来为此客户端服务。
